---
title: Fetching data with +page.js
excerpt: 
status: published
---
<script>
	import Homework from "$lib/components/Homework.svelte";
	import LessonPlan from "$lib/components/LessonPlan.svelte";
	import LabTime from "$lib/components/LabTime.svelte";
	import Achievement from "$lib/components/Achievement.svelte";
</script>

<LessonPlan {status}>

## Housekeeping
- [Mini-hackathon tomorrow](https://www.meetup.com/software-developers-of-calgary/events/bhsrvsyfcfbhc/) if you want to work on your final project with other nerds

---

## 1. Spoilers: Object Treasure Hunt
- [Achievement 1](/courses/cpnt-200/day-1#achievement)

**Source Code**
- [Finished Code](https://github.com/sait-wbdv/w23-200-dailies/tree/main/src/routes/d02-treasure-hunt)
- [Live Demo]()

---

## 2. Loading data with `+page.js`
[![Slides - ](/images/slides/sveltekit-loading-data.png)](https://sait-wbdv.github.io/slides/w23/cpnt-200/sveltekit-loading-data.html)

### Demo: Disney Characters Endpoints
- [REST APIs: Practice endpoints](https://gist.github.com/acidtone/673dfc5c11ce06e9e8cd6ce33609eb3c)

**Source Code**
- [Finished: `/characters`](https://github.com/sait-wbdv/w23-200-dailies/tree/main/src/routes/d02-disney-api/characters)
    - [Live Demo](https://w23-200-dailies.vercel.app/d02-disney-api/characters)
- [Finished: `/characters/:id`](https://github.com/sait-wbdv/w23-200-dailies/tree/main/src/routes/d02-disney-api/characters/%5Bid%5D)
    - [Live Demo](https://w23-200-dailies.vercel.app/d02-disney-api/characters/33)

---

## 3. Deep dive into destructuring assignment
Why exactly are we surrounding variables in `{}`?

**Example**
```js
import { page } from '$app/store`
```

### Materials
- MDN: [Destructuring assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)

---

## 4. Achievement Instructions
Choose one of the APIs (below) to base your routes on:
- `GET /posts`
- `GET /albums`
- `GET /todos`

### List entry route
1. Create a list entry route in your workspace that matches your chosen endpoint:
    ```
    /src/routes/posts
    ```
2. In this route, create a `+page.svelte` page and a `+page.js` page.
3. In `+page.svelte`, create your `data` prop:
		```html
    <script>
      export let data;
    </script>

    <h1>Posts</h1>
    ```
4. In `+page.js`, copy and paste the following `load` function code:
    ```js
    export const load = async ({ fetch }) => {
      const response = await fetch(`https://jsonplaceholder.typicode.com/[endpoint here]`);
      const apiData = await response.json();

      return {
        myData: apiData
      }
    }
    ```
		- change `[endpoint here]` to match your chosen endpoint (i.e. `posts`)
		- change `myData` to match your chosen endpoint (i.e. `posts`)
5. In `+page.svelte`:
		- Loop through `data.posts` using `{#each}` to display each item.
		- Link each item's `id` to its respective Item route:
				```js
        /posts/{data.post.id}
        ```

### Dynamic item route
1. Create a nested route parameter in your workspace that matches your chosen endpoint:
		```
    /src/routes/posts/[id]
    ```
2. Repeat Steps 2-4 above, except in Step 4:
		- Add `params` to the `load` parameter
				```js
        export const load = async ({ fetch, params }) => {
            ...
        }
        ```
		- Add `params.id` to the `fetch` url to request an individual item:
        ```js
        https://jsonplaceholder.typicode.com/posts/${params.id}
        ```
		- change `myData` to match the **singular** version of your chosen endpoint (i.e. `post`)
3. In `+page.svelte`:
		- Output each property contained in `data.post` onto the page.

</LessonPlan>

---

<Achievement {status}>

## Achievement 2

For this achievement, you will select a JSON API and display its data using SveltKit's `+page.js` asynchronous `load` function.

### 5 points: List entry route
Create a route that loops (with `{#each}`) through an array of objects returned from _ONE_ of the endpoints provided by [\{JSON\} Placeholder](https://jsonplaceholder.typicode.com/):

`GET` [`/posts`](https://jsonplaceholder.typicode.com/posts)<br>
`GET` [`/albums`](https://jsonplaceholder.typicode.com/albums)<br>
`GET` [`/todos`](https://jsonplaceholder.typicode.com/todos)

The resulting `+page.svelte` page should:
- use a sibling `+page.js` file to load data from the selected API;
- link each entry's `title` to its respective item route using an `id` route parameter (see below)

**Disney Examples**
- [Finished: `/characters`](https://github.com/sait-wbdv/w23-200-dailies/tree/main/src/routes/d02-disney-api/characters)
- [Live Demo](https://w23-200-dailies.vercel.app/d02-disney-api/characters)

### 5 points: Dynamic item route
Create a dynamic route nested inside the above list entry route so that:
- a `+page.js` page loads a single item based on an `id` route parameter;
- an "Item not found" page is displayed if the `id` is invalid.

**Disney Examples**
- [Finished: `/characters/:id`](https://github.com/sait-wbdv/w23-200-dailies/tree/main/src/routes/d02-disney-api/characters/%5Bid%5D)
- [Live Demo](https://w23-200-dailies.vercel.app/d02-disney-api/characters/33)

---

**Submission Instructions**
1. In a SvelteKit project for CPNT 200 Achievements, create a new route called `achievement-2` or similar;
2. Complete the above exercise;
3. Push your work to a new GitHub repo for CPNT 200 Achievements and deploy to Vercel;
4. Submit repo and live site links in Brightspace;

</Achievement>

<Homework {status}>

## Prep
### Reading list
- Free Code Camp: [Asynchronous Programming in JavaScript â€“ Guide for Beginners](https://www.freecodecamp.org/news/asynchronous-programming-in-javascript/)

### Watch list
- Codevolution: [Loading page data with +page.js](https://www.youtube.com/watch?v=iBctrIOg-Jw)

### Tools
- [JSON Placeholder](https://jsonplaceholder.typicode.com/)

### Reference: 
- [List of Public APIs](https://github.com/public-apis/public-apis)
- [REST APIs: Practice endpoints](https://gist.github.com/acidtone/673dfc5c11ce06e9e8cd6ce33609eb3c)

</Homework>